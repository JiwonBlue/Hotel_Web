--계정 생성
CONN SYS/JAVA1234 AS SYSDBA;
ALTER SESSION SET "_ORACLE_SCRIPT"=TRUE;
DROP USER EVEREST CASCADE;

CREATE USER EVEREST IDENTIFIED BY EVEREST123;
GRANT CONNECT, RESOURCE, UNLIMITED TABLESPACE TO EVEREST;
CONN EVEREST/EVEREST123;

SET LINE 200;
SET PAGESIZE 20;

DROP TABLE PAY_TABLE;
DROP TABLE FILE_TABLE;
DROP TABLE COMMENT_TABLE;
DROP TABLE BOARD_TABLE;
DROP TABLE RESERVE_TABLE;
DROP TABLE MEMBER_TABLE;
DROP TABLE ROOM_TABLE;
DROP TABLE ADMIN_TABLE;

DROP SEQUENCE ADMIN_TABLE_SEQ;
DROP SEQUENCE RESERVE_TABLE_SEQ;
DROP SEQUENCE BOARD_TABLE_SEQ;
DROP SEQUENCE COMMENT_TABLE_SEQ;
DROP SEQUENCE FILE_TABLE_SEQ;
DROP SEQUENCE PAY_TABLE_SEQ;

PURGE RECYCLEBIN;

--TABLE 생성
CREATE TABLE ADMIN_TABLE(
	ADMIN_ID VARCHAR2(10) NOT NULL CONSTRAINT ADMIN_ID_PK PRIMARY KEY, --어드민코드(아이디)(PK)
	ADMIN_NAME VARCHAR2(10) NOT NULL, --어드민이름
	ADMIN_PWD VARCHAR2(10) NOT NULL --어드민비밀번호
);
CREATE SEQUENCE ADMIN_TABLE_SEQ START WITH 1 INCREMENT BY 1 NOCACHE;

CREATE TABLE ROOM_TABLE(
	ROOM_CODE VARCHAR2(10) NOT NULL CONSTRAINT ROOM_CODE_PK PRIMARY KEY, --객실코드(PK)
	ROOM_TYPE VARCHAR2(10) NOT NULL, --객실타입
	ROOM_SIZE VARCHAR2(10) NOT NULL, --객실면적
	ROOM_COUNT NUMBER(10) NOT NULL, --객실정원
	ROOM_INFO VARCHAR(40) NOT NULL, --객실정보
	ROOM_PRICE NUMBER(10) NOT NULL --객실가격
);
--CREATE SEQUENCE ROOM_TABLE_SEQ START WITH 101 INCREMENT BY 1 NOCACHE;

CREATE TABLE MEMBER_TABLE(
	MEMBER_ID VARCHAR(30) NOT NULL CONSTRAINT MEMBER_ID_PK PRIMARY KEY, --회원정보CODE(PK)
	MEMBER_PWD VARCHAR(30) NOT NULL, --비밀번호
	MEMBER_NAME VARCHAR(10) NOT NULL, --이름
	MEMBER_PHONE VARCHAR(20) NOT NULL, --연락처
	MEMBER_BIRTHDAY DATE NOT NULL, --생년월일
	MEMBER_IN_OUT VARCHAR(10) NOT NULL --내/외국인
);

CREATE TABLE RESERVE_TABLE(
	RESERVE_CODE VARCHAR2(10) NOT NULL CONSTRAINT RESERVE_CODE_PK PRIMARY KEY, --예약CODE(PK)
	MEMBER_ID VARCHAR2(30) NOT NULL CONSTRAINT RESERVE_MEMBER_ID_FK REFERENCES MEMBER_TABLE(MEMBER_ID), --회원정보CODE(FK)
	ROOM_CODE VARCHAR2(10) NOT NULL CONSTRAINT RESERVE_ROOM_CODE_FK REFERENCES ROOM_TABLE(ROOM_CODE), --객실CODE(FK)
	RESERVE_START_DAY DATE NOT NULL, --이용시작일
	RESERVE_END_DAY DATE NOT NULL, --이용종료일
	RESERVE_COUNT NUMBER(10) NOT NULL --숙박인원
);
CREATE SEQUENCE RESERVE_TABLE_SEQ START WITH 1 INCREMENT BY 1 NOCACHE;

CREATE TABLE BOARD_TABLE(
	BOARD_CODE VARCHAR2(10) NOT NULL CONSTRAINT BOARD_CODE_PK PRIMARY KEY, --게시판코드(PK)
	BOARD_TITLE VARCHAR2(50) NOT NULL, --게시판제목
	BOARD_CONTENT VARCHAR2(1000) NOT NULL, --게시판내용
	MEMBER_ID VARCHAR2(30) NOT NULL CONSTRAINT BOARD_MEMBER_ID_FK REFERENCES MEMBER_TABLE(MEMBER_ID), --회원정보CODE(FK)
	BOARD_VIEW NUMBER(20), --게시판조회수
	BOARD_RDATE DATE NOT NULL, --게시판작성일
	BOARD_UDATE DATE NOT NULL --게시판수정일
);
CREATE SEQUENCE BOARD_TABLE_SEQ START WITH 1 INCREMENT BY 1 NOCACHE;

CREATE TABLE COMMENT_TABLE(
	COMMENT_CODE VARCHAR2(10) NOT NULL CONSTRAINT COMMENT_CODE_PK PRIMARY KEY, --댓글코드(PK)
	RECOMMENT_CODE VARCHAR2(10) NOT NULL CONSTRAINT RECOMMENT_COMMENT_CODE_FK REFERENCES COMMENT_TABLE(COMMENT_CODE), --대댓글코드(FK)
	COMMENT_CONTENT VARCHAR2(500) NOT NULL, --댓글내용
	COMMENT_RDATE DATE NOT NULL, --댓글작성날짜
	MEMBER_ID VARCHAR2(30) NOT NULL CONSTRAINT COMMENT_MEMBER_ID_FK REFERENCES MEMBER_TABLE(MEMBER_ID), --회원(FK)
	BOARD_CODE VARCHAR2(10) NOT NULL CONSTRAINT COMMENT_BOARD_CODE_FK REFERENCES BOARD_TABLE(BOARD_CODE) --게시판(FK)
);
CREATE SEQUENCE COMMENT_TABLE_SEQ START WITH 1 INCREMENT BY 1 NOCACHE;

CREATE TABLE FILE_TABLE(
	FILE_CODE VARCHAR2(10) NOT NULL CONSTRAINT FILE_CODE PRIMARY KEY, 
	FILE_OGNAME VARCHAR(50) NOT NULL,
	FILE_SAVENAME VARCHAR(100) NOT NULL, 
	FILE_SAVEPATH VARCHAR(50) NOT NULL, 
	FILE_SIZE VARCHAR(50) NOT NULL,
	BOARD_CODE VARCHAR2(10) NOT NULL CONSTRAINT FILE_BOARD_CODE_FK REFERENCES BOARD_TABLE(BOARD_CODE) --게시판(FK)
);
CREATE SEQUENCE FILE_TABLE_SEQ START WITH 1 INCREMENT BY 1 NOCACHE;


CREATE TABLE PAY_TABLE(
	PAY_CODE VARCHAR2(10) NOT NULL CONSTRAINT PAY_CODE PRIMARY KEY, --결제CODE(PK)
	RESERVE_CODE VARCHAR(10) NOT NULL CONSTRAINT PAY_RESERVE_CODE_FK REFERENCES RESERVE_TABLE(RESERVE_CODE), --예약CODE(FK)
	PAY_MONEY NUMBER(20) NOT NULL, --결제금액
	PAY_WHAT VARCHAR(10) NOT NULL, --결제수단
	PAY_BANK VARCHAR(10) NOT NULL, --결제은행
	PAY_DAY DATE NOT NULL --결제일시
);
CREATE SEQUENCE PAY_TABLE_SEQ START WITH 1 INCREMENT BY 1 NOCACHE;


--INSERT
INSERT INTO ADMIN_TABLE VALUES('ADMIN'||ADMIN_TABLE_SEQ.NEXTVAL, '김지원', 'KIM123');
INSERT INTO ADMIN_TABLE VALUES('ADMIN'||ADMIN_TABLE_SEQ.NEXTVAL, '조영태', 'JO123');
INSERT INTO ADMIN_TABLE VALUES('ADMIN'||ADMIN_TABLE_SEQ.NEXTVAL, '양현주', 'Y123');
INSERT INTO ADMIN_TABLE VALUES('ADMIN'||ADMIN_TABLE_SEQ.NEXTVAL, '신용빈', 'SIN123');

INSERT INTO ROOM_TABLE VALUES('ROOM101', 'STANDARD', '20평', 4, '55인치TV', 200000);
INSERT INTO ROOM_TABLE VALUES('ROOM102', 'STANDARD', '20평', 4, '55인치TV', 200000);
INSERT INTO ROOM_TABLE VALUES('ROOM103', 'STANDARD', '20평', 4, '55인치TV', 200000);
INSERT INTO ROOM_TABLE VALUES('ROOM201', 'DELUXE', '30평', 6, '70인치TV, 욕조', 300000);
INSERT INTO ROOM_TABLE VALUES('ROOM202', 'DELUXE', '30평', 6, '70인치TV, 욕조', 300000);
INSERT INTO ROOM_TABLE VALUES('ROOM203', 'DELUXE', '30평', 6, '70인치TV, 욕조', 300000);
INSERT INTO ROOM_TABLE VALUES('ROOM301', 'SUITE', '40평', 8, '79인치TV, 욕조', 400000);
INSERT INTO ROOM_TABLE VALUES('ROOM302', 'SUITE', '40평', 8, '79인치TV, 욕조', 400000);
INSERT INTO ROOM_TABLE VALUES('ROOM303', 'SUITE', '40평', 8, '79인치TV, 욕조', 400000);

INSERT INTO MEMBER_TABLE VALUES('P123@NAVER.COM', 'U12345', '엄용민', '010-9999-9888', '1999-06-28', '내국인');
INSERT INTO MEMBER_TABLE VALUES('T123@NAVER.COM', 'J12345', '조영태', '010-7799-8787', '1966-09-28', '내국인');
INSERT INTO MEMBER_TABLE VALUES('Y123@NAVER.COM', 'S12345', '강찬성', '010-6663-8558', '1970-05-22', '내국인');

INSERT INTO RESERVE_TABLE VALUES('RESERVE'||RESERVE_TABLE_SEQ.NEXTVAL, 'P123@NAVER.COM', 'ROOM101', '2023-07-15', '2023-07-17', 3);
INSERT INTO RESERVE_TABLE VALUES('RESERVE'||RESERVE_TABLE_SEQ.NEXTVAL, 'P123@NAVER.COM', 'ROOM102', '2023-07-15', '2023-07-17', 3);
INSERT INTO RESERVE_TABLE VALUES('RESERVE'||RESERVE_TABLE_SEQ.NEXTVAL, 'T123@NAVER.COM', 'ROOM202', '2023-07-15', '2023-07-17', 3);
INSERT INTO RESERVE_TABLE VALUES('RESERVE'||RESERVE_TABLE_SEQ.NEXTVAL, 'T123@NAVER.COM', 'ROOM203', '2023-07-15', '2023-07-17', 3);
INSERT INTO RESERVE_TABLE VALUES('RESERVE'||RESERVE_TABLE_SEQ.NEXTVAL, 'Y123@NAVER.COM', 'ROOM302', '2023-07-15', '2023-07-17', 3);
INSERT INTO RESERVE_TABLE VALUES('RESERVE'||RESERVE_TABLE_SEQ.NEXTVAL, 'Y123@NAVER.COM', 'ROOM303', '2023-07-15', '2023-07-17', 3);

INSERT INTO BOARD_TABLE VALUES(BOARD_TABLE_SEQ.NEXTVAL, '제목이다', '내용이다', 'P123@NAVER.COM', 0, SYSDATE, SYSDATE);
INSERT INTO BOARD_TABLE VALUES(BOARD_TABLE_SEQ.NEXTVAL, '이런제목', '이런내용', 'T123@NAVER.COM', 0, SYSDATE, SYSDATE);
INSERT INTO BOARD_TABLE VALUES(BOARD_TABLE_SEQ.NEXTVAL, '저런제목', '저런내용', 'Y123@NAVER.COM', 0, SYSDATE, SYSDATE);

INSERT INTO COMMENT_TABLE VALUES(COMMENT_TABLE_SEQ.NEXTVAL, COMMENT_TABLE_SEQ.CURRVAL, '댓글이다', SYSDATE, 'P123@NAVER.COM', 1);
INSERT INTO COMMENT_TABLE VALUES(COMMENT_TABLE_SEQ.NEXTVAL, COMMENT_TABLE_SEQ.CURRVAL, '나도댓글', SYSDATE, 'T123@NAVER.COM', 2);
INSERT INTO COMMENT_TABLE VALUES(COMMENT_TABLE_SEQ.NEXTVAL, 1, '대댓글!', SYSDATE, 'Y123@NAVER.COM', 1);
INSERT INTO COMMENT_TABLE VALUES(COMMENT_TABLE_SEQ.NEXTVAL, 2, '이것도대댓글!', SYSDATE, 'Y123@NAVER.COM', 2);

--파일생략(파일 필요)

INSERT INTO PAY_TABLE VALUES('PAY'||PAY_TABLE_SEQ.NEXTVAL, 'RESERVE1', 200000, '카드', '농협', '2023-07-11');
INSERT INTO PAY_TABLE VALUES('PAY'||PAY_TABLE_SEQ.NEXTVAL, 'RESERVE2', 200000, '카드', '농협', '2023-07-12');
INSERT INTO PAY_TABLE VALUES('PAY'||PAY_TABLE_SEQ.NEXTVAL, 'RESERVE3', 200000, '카드', '농협', '2023-06-26');
INSERT INTO PAY_TABLE VALUES('PAY'||PAY_TABLE_SEQ.NEXTVAL, 'RESERVE4', 200000, '카드', '농협', '2023-06-26');
INSERT INTO PAY_TABLE VALUES('PAY'||PAY_TABLE_SEQ.NEXTVAL, 'RESERVE5', 200000, '카드', '농협', '2023-06-26');
INSERT INTO PAY_TABLE VALUES('PAY'||PAY_TABLE_SEQ.NEXTVAL, 'RESERVE6', 200000, '카드', '농협', '2023-06-26');

--일단 다 INSERT 해서 테스트해보고 필요한부분만 고르자
--컬럼 크기들 다시 수정하자
--시퀸스 다시 넣고 FK값들 REFERENCES로 받아올 수 있다. 선배기수도 MEMBER 폰넘버를 MYMENU FK폰넘버로 받았다.
--MEMBER_NUM NUMBER(7) CONSTRAINT MEMBER_PK PRIMARY KEY,
--PHONE_NUM VARCHAR2(11) CONSTRAINT MYMENU_MEMBER_NUM_FK REFERENCES MEMBER(PHONE_NUM), -- FK
--유저를 삭제했다가 다시 생성하니까 DROP 문이 쓸모가 없는 것 같기도..

COMMIT;

--SELECT TNAME FROM TAB;
--DESC ROOM_TABLE;
--DESC ....

SELECT * FROM ADMIN_TABLE;
SELECT * FROM ROOM_TABLE;
SELECT * FROM MEMBER_TABLE;
SELECT * FROM RESERVE_TABLE;
SELECT * FROM BOARD_TABLE;
SELECT * FROM COMMENT_TABLE;
SELECT * FROM FILE_TABLE;
SELECT * FROM PAY_TABLE;